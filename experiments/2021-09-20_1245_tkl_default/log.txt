2021-09-20 12:45:05,440 INFO Running: ['matchmaker/train.py', '--config-file', 'config/train/defaults.yaml', 'config/train/data/example-minimal-dataset.yaml', 'config/train/models/tkl.yaml', '--run-name', 'tkl_default']
2021-09-20 12:45:05,460 INFO Torch seed: 208973249 
2021-09-20 12:46:53,667 INFO Model TKL total parameters: 576960086
2021-09-20 12:46:53,668 INFO Network: NeuralIR_Encoder(
  (word_embeddings): BasicTextFieldEmbedder(
    (token_embedder_tokens): Embedding()
  )
  (neural_ir_model): TKL_sigir20(
    (contextualizer): TransformerEncoder(
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=300, out_features=300, bias=True)
          )
          (linear1): Linear(in_features=300, out_features=300, bias=True)
          (dropout): Dropout(p=0, inplace=False)
          (linear2): Linear(in_features=300, out_features=300, bias=True)
          (norm1): LayerNorm((300,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((300,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0, inplace=False)
          (dropout2): Dropout(p=0, inplace=False)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=300, out_features=300, bias=True)
          )
          (linear1): Linear(in_features=300, out_features=300, bias=True)
          (dropout): Dropout(p=0, inplace=False)
          (linear2): Linear(in_features=300, out_features=300, bias=True)
          (norm1): LayerNorm((300,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((300,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0, inplace=False)
          (dropout2): Dropout(p=0, inplace=False)
        )
      )
    )
    (cosine_module): CosineMatrixAttention()
    (saturation_linear): Linear(in_features=2, out_features=1, bias=True)
    (saturation_linear2): Linear(in_features=2, out_features=1, bias=True)
    (saturation_linear3): Linear(in_features=2, out_features=1, bias=True)
    (sat_normer): LayerNorm((2,), eps=1e-05, elementwise_affine=True)
    (sat_emb_reduce1): Linear(in_features=300, out_features=1, bias=False)
    (dense): Linear(in_features=11, out_features=1, bias=False)
  )
)
2021-09-20 12:46:53,670 INFO we_params: word_embeddings.token_embedder_tokens.weight
2021-09-20 12:46:54,843 INFO [Epoch 0] --- Start training 
2021-09-20 12:47:57,398 INFO --------------------
2021-09-20 12:47:57,398 ERROR [train] Got exception: 
Traceback (most recent call last):
  File "C:\Users\qhuca\anaconda3\envs\matchmaker\lib\site-packages\allennlp\data\data_loaders\multiprocess_data_loader.py", line 417, in _iter_batches
    for batch, worker_error in iter(queue.get, (None, None)):
  File "C:\Users\qhuca\anaconda3\envs\matchmaker\lib\multiprocessing\queues.py", line 97, in get
    res = self._recv_bytes()
  File "C:\Users\qhuca\anaconda3\envs\matchmaker\lib\multiprocessing\connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "C:\Users\qhuca\anaconda3\envs\matchmaker\lib\multiprocessing\connection.py", line 305, in _recv_bytes
    waitres = _winapi.WaitForMultipleObjects(
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "matchmaker/train.py", line 319, in <module>
    for batch in input_loader:
  File "C:\Users\qhuca\anaconda3\envs\matchmaker\lib\site-packages\allennlp\data\data_loaders\multiprocess_data_loader.py", line 338, in __iter__
    yield from self._iter_batches()
  File "C:\Users\qhuca\anaconda3\envs\matchmaker\lib\site-packages\allennlp\data\data_loaders\multiprocess_data_loader.py", line 431, in _iter_batches
    self._join_workers(workers, queue, txs)
  File "C:\Users\qhuca\anaconda3\envs\matchmaker\lib\site-packages\allennlp\data\data_loaders\multiprocess_data_loader.py", line 483, in _join_workers
    tx.send("stop")
  File "C:\Users\qhuca\anaconda3\envs\matchmaker\lib\multiprocessing\connection.py", line 206, in send
    self._send_bytes(_ForkingPickler.dumps(obj))
  File "C:\Users\qhuca\anaconda3\envs\matchmaker\lib\multiprocessing\connection.py", line 280, in _send_bytes
    ov, err = _winapi.WriteFile(self._handle, buf, overlapped=True)
BrokenPipeError: [WinError 232] The pipe is being closed
2021-09-20 12:47:57,401 INFO Exiting from training early
